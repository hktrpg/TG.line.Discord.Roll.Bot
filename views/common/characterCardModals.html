<!-- Login Modal -->
<div class="modal fade" id="loginModalCenter" tabindex="-1" role="dialog" aria-labelledby="loginModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalCenterTitle">登入</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="loginForm">
                    <div class="form-group">
                        <label for="userName">用戶名</label>
                        <input type="text" 
                               class="form-control" 
                               id="userName" 
                               autocomplete="username"
                               placeholder="Enter userName">
                    </div>
                    <div class="form-group">
                        <label for="userPassword_id">密碼</label>
                        <input type="password" 
                               class="form-control" 
                               id="userPassword_id"
                               autocomplete="current-password"
                               placeholder="Enter userPassword">
                    </div>
                    <div class="alert alert-danger" id="warning" style="display: none;">
                        <strong>登入失敗</strong> 請檢查用戶名和密碼是否正確
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="showHelp()">說明</button>
                <button type="button" class="btn btn-primary" onclick="login()">登入</button>
            </div>
        </div>
    </div>
</div>

<!-- Logout Modal -->
<div class="modal fade" id="logoutModalCenter" tabindex="-1" role="dialog" aria-labelledby="logoutModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="logoutModalCenterTitle">登出確認</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p class="mb-0">確定要登出嗎？此操作會清除本機登入資訊並回到登入畫面。</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-danger" onclick="confirmLogout()">確認登出</button>
            </div>
        </div>
    </div>
    </div>

<!-- Card List Modal -->
<div class="modal fade" id="cardListModal" tabindex="-1" role="dialog" aria-labelledby="cardListModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="cardListModalLabel">選擇角色卡</h5>
            </div>
            <div class="modal-body">
                <form id="cardList-Form">
                    <div class="form-group" id="array-cardList">
                        <div class="d-flex align-items-center mb-2">
                            <input type="text" class="form-control form-control-sm mr-2" placeholder="搜尋角色卡名稱"
                                   v-model="searchQuery">
                            <select class="form-control form-control-sm" style="width:auto" v-model.number="pageSize">
                                <option :value="12">12/頁</option>
                                <option :value="24">24/頁</option>
                                <option :value="48">48/頁</option>
                                <option :value="96">96/頁</option>
                            </select>
                            <span class="ml-2 text-muted">共 {{ filteredCount }} 張</span>
                        </div>
                        <div class="row">
                            <div v-for="(item,index) in pagedList" :key="item._id || index" class="col-6 col-md-4 col-lg-3 mb-2">
                                <button type="button" class="btn btn-warning w-100"
                                    v-on:click="getTheSelectedOneByItem(item)">
                                    {{item.name}}</button>
                            </div>
                        </div>
                        <div class="d-flex justify-content-between align-items-center mt-2" v-if="totalPages > 1">
                            <button type="button" class="btn btn-sm btn-secondary" :disabled="page<=1" @click="prevPage">上一頁</button>
                            <div class="text-muted">第 {{ page }} / {{ totalPages }} 頁</div>
                            <button type="button" class="btn btn-sm btn-secondary" :disabled="page>=totalPages" @click="nextPage">下一頁</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Readme Modal -->
<div class="modal fade" id="readmeModalCenter" tabindex="-1" role="dialog" aria-labelledby="readmeModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="readmeModalLongTitle">使用說明</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="readme-content">
                    <h6>基本使用步驟：</h6>
                    <ol>
                        <li>選擇角色卡</li>
                        <li>點擊骰子圖示進行擲骰</li>
                        <li>點擊說明按鈕查看使用說明</li>
                    </ol>
                    <h6>詳細說明：</h6>
                    <p>請訪問 <a href="https://github.com/hktrpg/TG.line.Discord.Roll.Bot/wiki/Character-Card" target="_blank">GitHub Wiki</a> 查看完整使用說明。</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div> 

<!-- Public Confirm Modal -->
<div class="modal fade" id="publicConfirmModal" tabindex="-1" role="dialog" aria-labelledby="publicConfirmModalTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="publicConfirmModalTitle">公開角色卡確認</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>將「現在狀態」切換為「公開」後：</p>
                <ul>
                    <li>你的角色卡會顯示在 <a href="https://publiccard.hktrpg.com/" target="_blank" rel="noopener">publiccard.hktrpg.com</a></li>
                    <li>任何人都可以瀏覽該角色卡並進行簡單擲骰</li>
                    <li>你隨時可以改回「私人」，我們會立即儲存狀態</li>
                </ul>
                <p class="mb-0">確認要公開此角色卡嗎？</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="cardManager.getCard() && cardManager.getCard().cancelMakePublic && cardManager.getCard().cancelMakePublic()">取消</button>
                <button type="button" class="btn btn-primary" onclick="cardManager.getCard() && cardManager.getCard().confirmMakePublic && cardManager.getCard().confirmMakePublic()">確認公開並儲存</button>
            </div>
        </div>
    </div>
    </div>

<!-- Edit Mode Close Confirm Modal -->
<div class="modal fade" id="editModeCloseConfirmModal" tabindex="-1" role="dialog" aria-labelledby="editModeCloseConfirmModalTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editModeCloseConfirmModalTitle">關閉編輯模式確認</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p class="mb-0">您有未儲存的變更，請選擇以下操作：</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" onclick="confirmSaveChangesAndExitEditMode()">儲存變更</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">繼續修改</button>
                <button type="button" class="btn btn-danger" onclick="confirmExitEditModeWithoutSaving()">退出並還原</button>
            </div>
        </div>
    </div>
</div>